// Code generated by Wire. DO NOT EDIT.

//go:generate wire
//+build !wireinject

package main

import (
	"context"
	"database/sql"
	"gitlab.com/verygoodsoftwarenotvirus/logging/v2"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/server"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/server/http"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/admin"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/audit"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/auth"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/frontend"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/items"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/oauth2clients"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/users"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/app/services/webhooks"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/pkg/config"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/pkg/database"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/pkg/encoding"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/pkg/metrics"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/pkg/password"
	"gitlab.com/verygoodsoftwarenotvirus/todo/internal/pkg/search/bleve"
)

// Injectors from wire.go:

// BuildServer builds a server.
func BuildServer(ctx context.Context, cfg *config.ServerConfig, logger logging.Logger, dbm database.DataManager, db *sql.DB, authenticator password.Authenticator) (*server.Server, error) {
	serverSettings := config.ProvideConfigServerSettings(cfg)
	frontendSettings := config.ProvideConfigFrontendSettings(cfg)
	instrumentationHandler := frontend.ProvideMetricsInstrumentationHandlerForServer(cfg, logger)
	authSettings := config.ProvideConfigAuthSettings(cfg)
	userDataManager := database.ProvideUserDataManager(dbm)
	authAuditManager := database.ProvideAuthAuditManager(dbm)
	oAuth2ClientDataManager := database.ProvideOAuth2ClientDataManager(dbm)
	oAuth2ClientAuditManager := database.ProvideOAuth2ClientAuditManager(dbm)
	clientIDFetcher := oauth2clients.ProvideOAuth2ClientsServiceClientIDFetcher(logger)
	encoderDecoder := encoding.ProvideResponseEncoder(logger)
	unitCounterProvider := metrics.ProvideUnitCounterProvider()
	service, err := oauth2clients.ProvideOAuth2ClientsService(logger, oAuth2ClientDataManager, userDataManager, oAuth2ClientAuditManager, authenticator, clientIDFetcher, encoderDecoder, unitCounterProvider)
	if err != nil {
		return nil, err
	}
	oAuth2ClientValidator := auth.ProvideOAuth2ClientValidator(service)
	databaseSettings := config.ProvideConfigDatabaseSettings(cfg)
	sessionManager := config.ProvideSessionManager(authSettings, databaseSettings, db)
	sessionInfoFetcher := auth.ProvideAuthServiceSessionInfoFetcher()
	authService, err := auth.ProvideService(logger, authSettings, authenticator, userDataManager, authAuditManager, oAuth2ClientValidator, sessionManager, encoderDecoder, sessionInfoFetcher)
	if err != nil {
		return nil, err
	}
	typesAuthService := auth.ProvideAuthService(authService)
	frontendService := frontend.ProvideService(logger, frontendSettings)
	typesFrontendService := frontend.ProvideFrontendService(frontendService)
	auditLogDataManager := database.ProvideAuditLogEntryDataManager(dbm)
	entryIDFetcher := audit.ProvideAuditServiceItemIDFetcher(logger)
	auditSessionInfoFetcher := audit.ProvideAuditServiceSessionInfoFetcher()
	auditService := audit.ProvideService(logger, auditLogDataManager, entryIDFetcher, auditSessionInfoFetcher, encoderDecoder)
	auditLogDataService := audit.ProvideAuditLogEntryDataServer(auditService)
	itemDataManager := database.ProvideItemDataManager(dbm)
	itemAuditManager := database.ProvideItemAuditManager(dbm)
	itemIDFetcher := items.ProvideItemsServiceItemIDFetcher(logger)
	itemsSessionInfoFetcher := items.ProvideItemsServiceSessionInfoFetcher()
	searchSettings := config.ProvideSearchSettings(cfg)
	indexManagerProvider := bleve.ProvideBleveIndexManagerProvider()
	searchIndex, err := items.ProvideItemsServiceSearchIndex(searchSettings, indexManagerProvider, logger)
	if err != nil {
		return nil, err
	}
	itemsService, err := items.ProvideService(logger, itemDataManager, itemAuditManager, itemIDFetcher, itemsSessionInfoFetcher, encoderDecoder, unitCounterProvider, searchIndex)
	if err != nil {
		return nil, err
	}
	itemDataService := items.ProvideItemDataServer(itemsService)
	userAuditManager := database.ProvideUserAuditManager(dbm)
	userIDFetcher := users.ProvideUsersServiceUserIDFetcher(logger)
	usersSessionInfoFetcher := users.ProvideUsersServiceSessionInfoFetcher()
	usersService, err := users.ProvideUsersService(authSettings, logger, userDataManager, userAuditManager, authenticator, userIDFetcher, usersSessionInfoFetcher, encoderDecoder, unitCounterProvider)
	if err != nil {
		return nil, err
	}
	userDataService := users.ProvideUserDataServer(usersService)
	oAuth2ClientDataService := oauth2clients.ProvideOAuth2ClientDataServer(service)
	webhookDataManager := database.ProvideWebhookDataManager(dbm)
	webhookAuditManager := database.ProvideWebhookAuditManager(dbm)
	webhooksSessionInfoFetcher := webhooks.ProvideWebhooksServiceSessionInfoFetcher()
	webhookIDFetcher := webhooks.ProvideWebhooksServiceWebhookIDFetcher(logger)
	webhooksService, err := webhooks.ProvideWebhooksService(logger, webhookDataManager, webhookAuditManager, webhooksSessionInfoFetcher, webhookIDFetcher, encoderDecoder, unitCounterProvider)
	if err != nil {
		return nil, err
	}
	webhookDataService := webhooks.ProvideWebhookDataServer(webhooksService)
	adminUserDataManager := database.ProvideAdminUserDataManager(dbm)
	adminAuditManager := database.ProvideAdminAuditManager(dbm)
	adminSessionInfoFetcher := admin.ProvideAdminServiceSessionInfoFetcher()
	adminUserIDFetcher := admin.ProvideAdminServiceUserIDFetcher(logger)
	adminService, err := admin.ProvideService(logger, authSettings, authenticator, adminUserDataManager, adminAuditManager, sessionManager, encoderDecoder, adminSessionInfoFetcher, adminUserIDFetcher)
	if err != nil {
		return nil, err
	}
	typesAdminService := admin.ProvideAdminService(adminService)
	httpserverServer, err := httpserver.ProvideServer(serverSettings, frontendSettings, instrumentationHandler, typesAuthService, typesFrontendService, auditLogDataService, itemDataService, userDataService, oAuth2ClientDataService, webhookDataService, typesAdminService, dbm, logger, encoderDecoder)
	if err != nil {
		return nil, err
	}
	serverServer, err := server.ProvideServer(cfg, httpserverServer)
	if err != nil {
		return nil, err
	}
	return serverServer, nil
}

version: '3.3'

services:
  integration-server:
    build:
      context: .
      dockerfile: dockerfiles/coverage-server.Dockerfile
    ports:
      - '7070:7070'
    links:
      - webhook-receiver-server
    environment:
      DOCKER: 'true'
      RECEIVER: 'http://prober:9090'
    networks:
      main:
        aliases:
          - integration-server
    # logging:
    #   driver: none

  prober:
    build:
      context: .
      dockerfile: dockerfiles/prober.Dockerfile
    ports:
      - '9090:9090'
    environment:
      TARGET_ADDRESS: 'integration-server:7070'
      WEBSOCKET_CONNECTIONS: 10
      MIN_WEBSOCKET_LIFETIME: '30s'
      MAX_WEBSOCKET_LIFETIME: '1m'
    networks:
      main:
        aliases:
          - prober
    # logging:
    #   driver: none

networks:
  main:
